# Do not edit this file
# Editing this file manually might break Capima System
# If you think there is a bug, contact us at capima-bug@nntoan.com

<VirtualHost 127.0.0.1:81>
    Define SOCK unix:///var/run/APPNAME.sock|fcgi://127.0.0.1/
    ServerName APPNAME
    ServerAlias APPDOMAINS
    DocumentRoot "HOMEDIR/webapps/APPNAME/PUBLICPATH/"

    <IfModule dir_module>
        DirectoryIndex index.html index.php index.php2 index.php3 index.php4 index.php5
    </IfModule>

    <IfModule setenvif_module>
        SetEnvIf X-Forwarded-Proto https HTTPS=on
    </IfModule>

    RemoteIPHeader X-Real-IP
    RemoteIPInternalProxy 127.0.0.1


    <Directory />
        Require all granted
        Options -FollowSymLinks +SymLinksIfOwnerMatch
        AllowOverride AuthConfig FileInfo Indexes Limit Options=All,MultiViews
    </Directory>


    <FilesMatch "\.php$">
        SetHandler proxy:${SOCK}
    </FilesMatch>

    <Proxy ${SOCK}>
        ProxySet keepalive=On
        ProxySet timeout=30
        ProxySet retry=0
    </Proxy>

    ErrorLog "HOMEDIR/logs/apache2/APPNAME_error.log"

    LogLevel warn

    <IfModule log_config_module>

        LogFormat "%a %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" wcombined
        LogFormat "%h %l %u %t \"%r\" %>s %b" common

        <IfModule logio_module>
          # You need to enable mod_logio.c to use %I and %O
          LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
        </IfModule>

        CustomLog "HOMEDIR/logs/apache2/APPNAME_access.log" wcombined

    </IfModule>
</VirtualHost>